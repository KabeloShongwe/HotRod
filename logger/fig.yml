ldapauth:
   image: panoptix/ldap
   command: '-d 64'

cas:
   image: panoptix/cas
   links:
     - ldapauth:ldapauth
   volumes:
   #Mount /dev/urandom to improve entropy source and speed up Tomcat7 startup
     - /dev/urandom:/dev/urandom

elasticsearch:
   hostname: elasticsearch
   image: dockerfile/elasticsearch

redis:
   hostname: redis
   image: dockerfile/redis

logstashr2e:
   hostname: logstashr2e
   build: build/logstashr2e
   links:
     - redis:redis
     - elasticsearch:elasticsearch

kibana:
   hostname: kibana
   image: panoptix/kibana
   links:
     - elasticsearch:elasticsearch

internallogvolumes:
   build: build/logvolumes 

internallogstashs2r:
   hostname: logstashs2r
   build: build/logstashs2r
   links:
     - redis:redis
   volumes_from:
     - internallogvolumes
   
internalrsyslog:
   hostname: internalrsyslog
   image: panoptix/rsyslog
   volumes_from:
     - logvolumes

logspout:
   hostname: logspout
   image: progrium/logspout
   links:
     - internalrsyslog:syslog
   volumes:
     - /var/run/docker.sock:/tmp/docker.sock
   command:
     - syslog://syslog:514

logvolumes:
   build: build/logvolumes

logstashs2r:
   hostname: logstashs2r
   build: build/logstashs2r
   links:
     - redis:redis
   volumes_from:
     - logvolumes

rsyslog:
   hostname: rsyslog
   image: panoptix/rsyslog
   volumes_from:
     - logvolumes
   ports:
     - 514:514/tcp
     - 514:514/udp

kibanarproxy:
   build: site/docker-kibanarproxy
   links:
     - kibana:kibana
     - cas:cas

sslrproxy:
   image: panoptix/sslrproxy
   links:
     - kibanarproxy:kibanarproxy
     - cas:cas
   ports:
     - 443:443

