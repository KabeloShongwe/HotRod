#!/bin/bash

# Run this script to get the initial repos prepped, as well as generate the custom config 
# files

set -e 

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
cd $DIR

# Grab the latest hotrod-composition for our git server
echo "HotRod Composition..."
if [ -d $DIR/project/hotrod ]; then
  cd $DIR/project/hotrod
  git pull origin master
else
  cd $DIR/project
  git clone https://github.com/panoptix-za/hotrod-composition.git hotrod
fi
git remote | grep hotrod || git remote add hotrod https://admin@127.0.0.1:8443/r/hotrod-composition.git
git config http.sslVerify false

echo "HotRod Admin..."
if [ -d $DIR/project/admin ]; then
  cd $DIR/project/admin
  git pull origin master
else
  cd $DIR/project
  git clone {{ hotrod_admin }} admin
fi
git remote | grep hotrod || git remote add hotrod https://admin@127.0.0.1:8443/r/hotrod-admin.git
git config http.sslVerify false

echo "HotRod ProjectFS..."
if [ -d $DIR/project/projectfs ]; then
  cd $DIR/project/projectfs
  git pull origin master
else
  cd $DIR/project
  git clone {{ hotrod_projectfs }} projectfs
fi
git remote | grep hotrod || git remote add hotrod https://admin@127.0.0.1:8443/r/hotrod-projectfs.git
git config http.sslVerify false

cd $DIR
echo "Done..."



